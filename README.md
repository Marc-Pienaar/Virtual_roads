# Virtual_roads
** SAEON BEA Virtual raods algorithm example**

The virtual roads algorithm was developed as part of the South African Environmental Observation Network BioEnergy-Atlas (SAEON BEA) generalisable feasibility model. It is written in python and uses the scikit-image open source image processing library for its minimum cost path routing (https://github.com/scikit-image/scikit-image; Van der Walt, et al., 2014). Each virtual road represents a theoretical set of paths (following a slope < 15 degrees) that could be navigated by an off-road vehicle (tractor trailer combination). These virtual roads have been created at every _n_km equally spaced interval and represent paths from origin points (areas where no roads exist) to the closest road segment according to South Africa’s National Geo-spatial Information (NGI) 2019 road layer (http://www.ngi.gov.za). The cost surface is based on 1-arcsecond (~30 meter) resolution Shuttle Radar Topography Mission (SRTM) version 3 (also known as SRTM plus) digital elevation model (DEM) (https://lpdaac.usgs.gov/news/nasa-shuttle-radar-topography-mission-srtm-version-30-srtm-plus-product-release/). All major hydrological obstacles (Rivers, dams, lakes, etc.) and areas with an average slope < 15 degrees have been removed from the cost surface and treated as obstacles. Due to the massive size of the cost surface when merged (2 711 921 602 pixels), the algorithm uses a variable window approach to avoid edge effects from individual SRTM tiles, by cropping sections from the larger merged cost surface into computationally manageable ‘chunks’. Each window or ‘cost surface crop’ is determined by first selecting an origin point and finding a small subset of its nearest neighbours using a standard Euclidean distance function. A further set of the closest destination points (road points in other words) associated with each of these origin points is also extracted using a Euclidean distance function. These origin and destination points (road points) are then combined to get an extent (with some overlap) which is used to crop the larger cost surface and process the virtual roads in a batch operation. Once a ‘chunk’ or batch of paths have been calculated, they are saved as shapefiles, and the origin points used to create these paths are removed from further analysis. The process is repeated in this manner until all origin points have been depleted. An overview and eample of the algorithm is provided below. 

![Virtual_roads_thread_marc_pienaar](https://user-images.githubusercontent.com/50328370/115216300-a976ac00-a104-11eb-8ae5-abb77d9517e0.png)
Fgure 1. overview of the SAEON BEA virtual roads algorithm 

The SAEON BEA virtual roads used a merged SRTM v3 DEM covering South Africa at 1-arcsecond (~30m) resolution (2 711 921 602 pixels) for its cost surface. In this example, a much smaller area is used to illustrate more detailed functionality. The region of Interest (ROI) used in this example is near the town of Upington on the Orange River, South Africa (see figure 2) 
